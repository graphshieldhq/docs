(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{468:function(t,s,a){"use strict";a.r(s);var e=a(25),r=Object(e.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"integrate-your-apps-with-graphshield"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#integrate-your-apps-with-graphshield"}},[t._v("#")]),t._v(" Integrate your apps with GraphShield")]),t._v(" "),a("blockquote",[a("p",[t._v("GraphShield was designed so that you can integrate your app with almost zero change to your code. "),a("strong",[t._v("No external agent, nothing to install, nada, zero!")])])]),t._v(" "),a("p",[a("strong",[t._v("ABSTRACT")])]),t._v(" "),a("p",[t._v("Under the hood, you access GraphShield simply by calling "),a("code",[t._v("microsoftgraph.graphshield.app")]),t._v(" instead of the regular "),a("code",[t._v("graph.microsoft.com")]),t._v(" URL. It means that you can integrate your app with GraphShield easily, in a snap, in a very transparent way.")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://graph.microsoft.com/v1.0/me'")]),t._v("            "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Instead of this")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://microsoftgraph.graphshield.app/v1.0/me'")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// Use this")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("Yes, it's that simple!")]),t._v(" "),a("p",[t._v("To understand more deeply what a full transaction looks like and how a request is processed, see "),a("a",{attrs:{href:"/how-does-it-work"}},[t._v("how does it works")]),t._v(".")]),t._v(" "),a("h2",{attrs:{id:"how-to-integrate-your-app-with-graphshield"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-to-integrate-your-app-with-graphshield"}},[t._v("#")]),t._v(" How to integrate your app with GraphShield?")]),t._v(" "),a("h3",{attrs:{id:"if-you-re-using-a-rest-client"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#if-you-re-using-a-rest-client"}},[t._v("#")]),t._v(" If you're using a REST client")]),t._v(" "),a("p",[t._v("Using any REST-compatible client, just include the GraphShield base URL in your requests:")]),t._v(" "),a("div",{staticClass:"language-javascript line-numbers-mode"},[a("div",{staticClass:"highlight-lines"},[a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-javascript"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GRAPHSHIELD_URL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://microsoftgraph.graphshield.app'")]),t._v("\nrequest\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token constant"}},[t._v("GRAPHSHIELD_URL")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/v1.0/me'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("set")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Authorization'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'Bearer '")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v(" accessToken"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("end")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token parameter"}},[t._v("err"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" res")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("This technique applies to any REST-compatible client, such as "),a("code",[t._v("fetch")]),t._v(", "),a("code",[t._v("node-fetch")]),t._v(", "),a("code",[t._v("axios")]),t._v("... in any language.")])]),t._v(" "),a("h3",{attrs:{id:"if-you-re-using-the-microsoft-graph-client"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#if-you-re-using-the-microsoft-graph-client"}},[t._v("#")]),t._v(" If you're using the Microsoft Graph Client")]),t._v(" "),a("p",[t._v("If you're using the Microsoft Graph Client SDK, just include the "),a("code",[t._v("baseUrl")]),t._v(" option to your Microsoft Graph client constructor, as highlighted:")]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br"),a("br"),a("br"),a("br"),a("br")]),a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" options "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  authProvider"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token literal-property property"}},[t._v("baseUrl")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'https://microsoftgraph.graphshield.app/'")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" client "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("init")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("options"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("let")]),t._v(" res "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("await")]),t._v(" client"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("api")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v("'/me'")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("get")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br")])]),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[t._v("Note")]),t._v(" "),a("p",[t._v("This technique should work with the Microsoft Graph Client in any language, "),a("code",[t._v("Javascript")]),t._v(", "),a("code",[t._v("C#")]),t._v(", "),a("code",[t._v("Java")]),t._v("...")])]),t._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[t._v("Using a specific Microsoft Graph environment? (GOV, DOD, DE...)")]),t._v(" "),a("p",[t._v("The Microsoft Graph API is available from different environments, and you have to use a different URL for each of them, for instance:")]),t._v(" "),a("ul",[a("li",[t._v("Microsoft Graph for US Government L4: "),a("code",[t._v("https://graph.microsoft.us")])]),t._v(" "),a("li",[t._v("Microsoft Graph for US Government L5 (DOD): "),a("code",[t._v("https://dod-graph.microsoft.us")])]),t._v(" "),a("li",[t._v("Microsoft Graph Germany: "),a("code",[t._v("https://graph.microsoft.de")])])]),t._v(" "),a("p",[t._v("See "),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/graph/deployments#microsoft-graph-and-graph-explorer-service-root-endpoints",target:"_blank",rel:"noopener noreferrer"}},[t._v("Microsoft Graph root endpoints"),a("OutboundLink")],1),t._v(" for reference.")]),t._v(" "),a("p",[t._v("If you're in the situation where you need to access one of these specific Microsoft Graph environments, just "),a("a",{attrs:{href:"https://www.graphshield.io/#contact",target:"_blank",rel:"noopener noreferrer"}},[t._v("contact us"),a("OutboundLink")],1),t._v(".")])]),t._v(" "),a("h3",{attrs:{id:"if-you-re-using-power-automate-or-powerapps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#if-you-re-using-power-automate-or-powerapps"}},[t._v("#")]),t._v(" If you're using Power Automate or PowerApps")]),t._v(" "),a("p",[t._v("If you're using Power Automate or PowerApps to access the Microsoft Graph, we've got you covered too! Just include the GraphShield base URL in the "),a("code",[t._v("URI")]),t._v(" field of your "),a("code",[t._v("HTTP")]),t._v(" action:")]),t._v(" "),a("p",[a("img",{attrs:{src:"/img/integrate-powerautomate.png",alt:"Power Automate integration"}})]),t._v(" "),a("h2",{attrs:{id:"next-steps"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#next-steps"}},[t._v("#")]),t._v(" Next Steps")]),t._v(" "),a("p",[t._v("Well... you're good to go! Once you've updated your base URL, GraphShield take care of everything so that you don't have to.")]),t._v(" "),a("p",[t._v('But if you want to understand how GraphShield handles "edge cases", please refer to the following articles:')]),t._v(" "),a("ul",[a("li",[a("a",{attrs:{href:"/integration/authentication"}},[t._v("Authentication")])]),t._v(" "),a("li",[a("a",{attrs:{href:"/integration/async-operations"}},[t._v("Async Operations")])]),t._v(" "),a("li",[a("a",{attrs:{href:"/integration/subscriptions"}},[t._v("Subscriptions")])]),t._v(" "),a("li",[a("a",{attrs:{href:"/integration/errors"}},[t._v("Errors Management")])]),t._v(" "),a("li",[a("a",{attrs:{href:"/integration/throttling"}},[t._v("Throttling")])])])])}),[],!1,null,null,null);s.default=r.exports}}]);