(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{469:function(t,e,a){"use strict";a.r(e);var s=a(25),r=Object(s.a)({},(function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"async-operations"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#async-operations"}},[t._v("#")]),t._v(" Async Operations")]),t._v(" "),a("blockquote",[a("p",[t._v("Some Microsoft Graph operations require indeterminate time to complete. Instead of waiting until the action is complete before returning a response, Microsoft Graph may use a long running actions pattern. This pattern provides your app a way to poll for status updates on a long running action, without any request waiting for the action to complete.")])]),t._v(" "),a("h2",{attrs:{id:"examples"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#examples"}},[t._v("#")]),t._v(" Examples")]),t._v(" "),a("p",[t._v("When a Microsoft Graph operation transcends the lifetime of a single API request, it returns a "),a("code",[t._v("202 Accepted")]),t._v(" response code with a "),a("code",[t._v("Location")]),t._v(" header, that you can periodically check by making a GET request to this location.")]),t._v(" "),a("p",[t._v("An example is the "),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/graph/api/team-clone",target:"_blank",rel:"noopener noreferrer"}},[t._v("Clone a team"),a("OutboundLink")],1),t._v(" operation that uses a "),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/graph/api/resources/teamsasyncoperation",target:"_blank",rel:"noopener noreferrer"}},[t._v("teamsAsyncOperation resource type"),a("OutboundLink")],1),t._v(":")]),t._v(" "),a("div",{staticClass:"language-HTTP line-numbers-mode"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br")]),a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[a("span",{pre:!0,attrs:{class:"token response-status"}},[a("span",{pre:!0,attrs:{class:"token http-version property"}},[t._v("HTTP/1.1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token status-code number"}},[t._v("202")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token reason-phrase string"}},[t._v("Accepted")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token header"}},[a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Location")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("/teams({id})/operations({opId})")])]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("p",[t._v("Another example is the "),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/graph/api/driveitem-copy",target:"_blank",rel:"noopener noreferrer"}},[t._v("Copy a DriveItem"),a("OutboundLink")],1),t._v(" operation that uses an "),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/graph/api/resources/asyncjobstatus",target:"_blank",rel:"noopener noreferrer"}},[t._v("AsyncJobStatus resource"),a("OutboundLink")],1),t._v(":")]),t._v(" "),a("div",{staticClass:"language-HTTP line-numbers-mode"},[a("div",{staticClass:"highlight-lines"},[a("br"),a("div",{staticClass:"highlighted"},[t._v(" ")]),a("br")]),a("pre",{pre:!0,attrs:{class:"language-http"}},[a("code",[a("span",{pre:!0,attrs:{class:"token response-status"}},[a("span",{pre:!0,attrs:{class:"token http-version property"}},[t._v("HTTP/1.1")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token status-code number"}},[t._v("202")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token reason-phrase string"}},[t._v("Accepted")])]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token header"}},[a("span",{pre:!0,attrs:{class:"token header-name keyword"}},[t._v("Location")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token header-value"}},[t._v("https://contoso.sharepoint.com/_api/v2.0/monitor/{id}")])]),t._v("\n")])]),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br")])]),a("h2",{attrs:{id:"how-graphshield-makes-it-transparent"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#how-graphshield-makes-it-transparent"}},[t._v("#")]),t._v(" How GraphShield makes it transparent?")]),t._v(" "),a("p",[t._v("To make sure that your app doesn't try by accident to bypass GraphShield by automatically following this kind of dynamically generated location URL, GraphShield dynamically rewrites the "),a("code",[t._v("Location")]),t._v(" HTTP header to replace URLs such as "),a("code",[t._v("https://api.onedrive.com/monitor/{id}")]),t._v(" by "),a("code",[t._v("https://microsoftgraph.graphshield.app?location=https://api.onedrive.com/monitor/{id}")]),t._v(", making this operation entirely transparent for your app.")])])}),[],!1,null,null,null);e.default=r.exports}}]);