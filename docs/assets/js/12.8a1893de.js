(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{462:function(e,t,a){"use strict";a.r(t);var n=a(25),o=function(e){e.options.__data__block__={mermaid_382ee1a8:"sequenceDiagram\n\n    autonumber\n\n    participant client as Client\n    participant gs as GraphShield\n    participant msg as Microsoft Graph\n    participant mip as Microsoft identity platform\n    \n    client ->> +gs: Request with access token\n    gs --\x3e> +msg: If inbound policies checks OK\n    msg ->> +mip: Authentication\n    mip --\x3e> +msg: If authentication OK\n    msg --\x3e> +gs: If outbound policies checks OK\n    gs ->> +client: Response\n",mermaid_64a570e4:"sequenceDiagram\n\n    autonumber\n\n    participant client as Client\n    participant gs as GraphShield\n    participant mip as Microsoft Identity Platform\n    \n    client ->> +gs: GET with virtual app id\n    gs ->> +mip: GET /Authorize\n    mip --\x3e> +gs: If authentication OK\n    gs ->> +client: Authentication code\n\n    client ->> +gs: POST with virtual app id/secret + authentication code\n    gs ->> +mip: POST /Token\n    mip --\x3e> +gs: If authentication code OK\n    gs ->> +client: Access and refresh tokens\n",mermaid_64a5709c:"sequenceDiagram\n\n    autonumber\n\n    participant client as Client\n    participant gs as GraphShield\n    participant mip as Microsoft Identity Platform\n    \n    client ->> +gs: GET with virtual app id\n    gs ->> +mip: GET /adminconsent\n    mip --\x3e> +gs: If authentication and grant OK\n    gs ->> +client: Admin consent result\n\n    client ->> +gs: POST with virtual app id/secret\n    gs ->> +mip: POST /Token\n    mip --\x3e> +gs: If app id/secret combination OK\n    gs ->> +client: Access token\n"}},r=Object(n.a)({},(function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":e.$parent.slotKey}},[a("h1",{attrs:{id:"authentication"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#authentication"}},[e._v("#")]),e._v(" Authentication")]),e._v(" "),a("blockquote",[a("p",[e._v("GraphShield was designed so that it interfere as less as possible with your authentication process.")])]),e._v(" "),a("h2",{attrs:{id:"abstract"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#abstract"}},[e._v("#")]),e._v(" Abstract")]),e._v(" "),a("p",[e._v("GraphShield supports two modes of authentication, "),a("code",[e._v("Standard")]),e._v(" and "),a("code",[e._v("Hardened")]),e._v(".")]),e._v(" "),a("div",{staticClass:"custom-block tip"},[a("p",{staticClass:"custom-block-title"},[e._v("TIP")]),e._v(" "),a("ul",[a("li",[e._v("The "),a("code",[e._v("Standard")]),e._v(" mode is perfect to use GraphShield without any additional constraints.")]),e._v(" "),a("li",[e._v("The "),a("code",[e._v("Hardened")]),e._v(" mode may be required when you're dealing with a strictly controlled Microsoft 365 environment.")])])]),e._v(" "),a("h3",{attrs:{id:"standard-mode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#standard-mode"}},[e._v("#")]),e._v(" Standard mode")]),e._v(" "),a("p",[e._v("In standard mode, to call the Microsoft Graph API through GraphShield, your application just need to acquire a regular OAuth 2.0 Access token from the Microsoft Identity Platform, and present it in either of the following:")]),e._v(" "),a("ul",[a("li",[e._v("The HTTP "),a("code",[e._v("Authorization")]),e._v(" request header, as a "),a("code",[e._v("Bearer")]),e._v(" token")]),e._v(" "),a("li",[e._v("The graph client constructor, when using a Microsoft Graph client library")])]),e._v(" "),a("Mermaid",{attrs:{id:"mermaid_382ee1a8",graph:e.$dataBlock.mermaid_382ee1a8}}),a("p",[e._v("It means that in standard mode, "),a("strong",[e._v("GraphShield is completely transparent regarding your authentication process")]),e._v(", as you're dealing directly with the Microsoft Identity Platform. Therefore you can refer to the standard "),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/graph/auth/",target:"_blank",rel:"noopener noreferrer"}},[e._v("Microsoft Graph auth overview"),a("OutboundLink")],1),e._v(" for reference to understand how to acquire an access token.")]),e._v(" "),a("h3",{attrs:{id:"hardened-mode"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#hardened-mode"}},[e._v("#")]),e._v(" Hardened mode")]),e._v(" "),a("p",[e._v('To cope with advanced security and compliance requirements in certain Microsoft 365 environments, GraphShield offers an additional layer of security for Microsoft 365 organizations through the concept of "Virtual Tokens".')]),e._v(" "),a("p",[a("strong",[e._v("Virtual Tokens prevents apps from directly accessing real application id and secrets, bringing an additional layer of security by completely preventing an app to be able to bypass GraphShield and to make direct requests to the Microsoft Graph.")])]),e._v(" "),a("p",[e._v("With GraphShield, they are only two differences with the regular flow:")]),e._v(" "),a("ul",[a("li",[e._v("You're calling "),a("code",[e._v("https://microsoftidentity.graphshield.app")]),e._v(" instead of the regular "),a("code",[e._v("https://login.microsoftonline.com")]),e._v(" URLs.")]),e._v(" "),a("li",[e._v("You're passing a virtual app id and a virtual app secret instead of the real one. These app id and secret are verified then dynamically substituted by the real one during the proxying process.")])]),e._v(" "),a("p",[e._v("We're currently supporting virtual tokens in these two main scenarios, that should cover 99% of the situations:")]),e._v(" "),a("ul",[a("li",[e._v("Access on behalf of a user: Used by "),a("strong",[e._v("single page apps")]),e._v(", "),a("strong",[e._v("web apps")]),e._v(", and "),a("strong",[e._v("natively installed apps")])]),e._v(" "),a("li",[e._v("Access without a user: Used for "),a("strong",[e._v("server-to-server")]),e._v(" interactions that must run in the background")])]),e._v(" "),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("Other OAuth 2.0 and OpenID protocols")]),e._v(" "),a("p",[e._v("If you need to use other protocols, such as "),a("code",[e._v("OAuth 2.0 on-behalf-of flow")]),e._v(" or "),a("code",[e._v("OAuth 2.0 device code flow")]),e._v(", just "),a("a",{attrs:{href:"https://www.graphshield.io/#contact",target:"_blank",rel:"noopener noreferrer"}},[e._v("contact us"),a("OutboundLink")],1),e._v(".")])]),e._v(" "),a("h4",{attrs:{id:"access-on-behalf-of-a-user"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#access-on-behalf-of-a-user"}},[e._v("#")]),e._v(" Access on behalf of a user")]),e._v(" "),a("p",[e._v("The "),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-auth-code-flow",target:"_blank",rel:"noopener noreferrer"}},[e._v("OAuth 2.0 authorization code flow"),a("OutboundLink")],1),e._v(" is described in "),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc6749",target:"_blank",rel:"noopener noreferrer"}},[e._v("section 4.1 of the OAuth 2.0 specification"),a("OutboundLink")],1),e._v(". It's used to perform authentication and authorization in the majority of app types, including single page apps, web apps, and natively installed apps. The flow enables apps to securely acquire access_tokens that can be used to access resources secured by the Microsoft identity platform, as well as refresh tokens to get additional access_tokens, and ID tokens for the signed in user.")]),e._v(" "),a("p",[e._v("By using GraphShield, the resulting process is completely transparent and does not impact your app:")]),e._v(" "),a("Mermaid",{attrs:{id:"mermaid_64a570e4",graph:e.$dataBlock.mermaid_64a570e4}}),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("Using a national environment? (US, DE, CN...)")]),e._v(" "),a("p",[e._v("See "),a("a",{attrs:{href:"#using-a-microsoft-identity-platform-national-environment"}},[e._v("Using a specific Microsoft Identity Platform environment")]),e._v(" if required.")])]),e._v(" "),a("h4",{attrs:{id:"access-without-a-user"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#access-without-a-user"}},[e._v("#")]),e._v(" Access without a user")]),e._v(" "),a("p",[e._v("You can use the "),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow",target:"_blank",rel:"noopener noreferrer"}},[e._v("OAuth 2.0 client credentials grant"),a("OutboundLink")],1),e._v(" specified in "),a("a",{attrs:{href:"https://tools.ietf.org/html/rfc6749#section-4.4",target:"_blank",rel:"noopener noreferrer"}},[e._v("RFC 6749"),a("OutboundLink")],1),e._v(', sometimes called "two-legged OAuth", to access web-hosted resources by using the identity of an application. This type of grant is commonly used for server-to-server interactions that must run in the background, without immediate interaction with a user. These types of applications are often referred to as daemons or service accounts.')]),e._v(" "),a("p",[e._v("By using GraphShield, the resulting process is completely transparent and does not impact your app:")]),e._v(" "),a("Mermaid",{attrs:{id:"mermaid_64a5709c",graph:e.$dataBlock.mermaid_64a5709c}}),a("div",{staticClass:"custom-block warning"},[a("p",{staticClass:"custom-block-title"},[e._v("Using a national environment? (US, DE, CN...)")]),e._v(" "),a("p",[e._v("See "),a("a",{attrs:{href:"#using-a-microsoft-identity-platform-national-environment"}},[e._v("Using a specific Microsoft Identity Platform environment")]),e._v(" if required.")])]),e._v(" "),a("h2",{attrs:{id:"using-a-microsoft-identity-platform-national-environment"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#using-a-microsoft-identity-platform-national-environment"}},[e._v("#")]),e._v(" Using a Microsoft Identity Platform national environment")]),e._v(" "),a("p",[e._v("The Microsoft Identity Platform is available from different environments, and you have to use a different URL for each of them, for instance:")]),e._v(" "),a("ul",[a("li",[e._v("Azure AD for US Government: "),a("code",[e._v("https://login.microsoftonline.us")])]),e._v(" "),a("li",[e._v("Azure AD Germany: "),a("code",[e._v("https://login.microsoftonline.de")])]),e._v(" "),a("li",[e._v("Azure AD China operated by 21Vianet: "),a("code",[e._v("https://login.chinacloudapi.cn")])])]),e._v(" "),a("p",[e._v("See "),a("a",{attrs:{href:"https://docs.microsoft.com/en-us/graph/deployments#app-registration-and-token-service-root-endpoints",target:"_blank",rel:"noopener noreferrer"}},[e._v("Token service root endpoints"),a("OutboundLink")],1),e._v(" for reference.")]),e._v(" "),a("p",[e._v("If you're in the situation where you need to access one of these specific Microsoft Identity Platform environments, just "),a("a",{attrs:{href:"https://www.graphshield.io/#contact",target:"_blank",rel:"noopener noreferrer"}},[e._v("contact us"),a("OutboundLink")],1),e._v(".")])],1)}),[],!1,null,null,null);"function"==typeof o&&o(r);t.default=r.exports}}]);