<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Authentication | GraphShield | Docs</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/favicon.ico">
    <meta name="description" content="GraphShield was designed so that it interfere as less as possible with your authentication process.">
    <meta name="twitter:title" content="Authentication">
    <meta name="twitter:description" content="GraphShield was designed so that it interfere as less as possible with your authentication process.">
    <meta name="twitter:card" content="summary">
    <meta property="og:type" content="article">
    <meta property="og:title" content="Authentication">
    <meta property="og:description" content="GraphShield was designed so that it interfere as less as possible with your authentication process.">
    <meta itemprop="name" content="Authentication">
    <meta itemprop="description" content="GraphShield was designed so that it interfere as less as possible with your authentication process.">
    
    <link rel="preload" href="/assets/css/0.styles.436420f3.css" as="style"><link rel="preload" href="/assets/js/app.800fda4e.js" as="script"><link rel="preload" href="/assets/js/2.356b9677.js" as="script"><link rel="preload" href="/assets/js/12.8a1893de.js" as="script"><link rel="prefetch" href="/assets/js/10.d54d0b71.js"><link rel="prefetch" href="/assets/js/11.72d646f8.js"><link rel="prefetch" href="/assets/js/13.d2d3960b.js"><link rel="prefetch" href="/assets/js/14.8e6c8e70.js"><link rel="prefetch" href="/assets/js/15.409abdfb.js"><link rel="prefetch" href="/assets/js/16.bc0ad2d9.js"><link rel="prefetch" href="/assets/js/17.bc70724b.js"><link rel="prefetch" href="/assets/js/18.f61880d6.js"><link rel="prefetch" href="/assets/js/19.b6ed459d.js"><link rel="prefetch" href="/assets/js/20.8469898b.js"><link rel="prefetch" href="/assets/js/21.9daa31ae.js"><link rel="prefetch" href="/assets/js/22.e6e57b7c.js"><link rel="prefetch" href="/assets/js/23.447709bf.js"><link rel="prefetch" href="/assets/js/3.68bee775.js"><link rel="prefetch" href="/assets/js/4.21d8355b.js"><link rel="prefetch" href="/assets/js/5.75eb39e3.js"><link rel="prefetch" href="/assets/js/6.007e69c5.js"><link rel="prefetch" href="/assets/js/7.87824bf7.js"><link rel="prefetch" href="/assets/js/8.84cfd5e3.js"><link rel="prefetch" href="/assets/js/9.d6d3930c.js">
    <link rel="stylesheet" href="/assets/css/0.styles.436420f3.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/" class="home-link router-link-active"><img src="/logo.png" alt="GraphShield | Docs" class="logo"> <span class="site-name can-hide">GraphShield | Docs</span></a> <div class="links"><!----> <div class="user-settings"><a href="#" class="settings-button"><svg aria-hidden="true" data-prefix="fas" data-icon="cog" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="svg-inline--fa fa-cog fa-w-16 settings-icon"><path fill="currentColor" d="M444.788 291.1l42.616 24.599c4.867 2.809 7.126 8.618 5.459 13.985-11.07 35.642-29.97 67.842-54.689 94.586a12.016 12.016 0 0 1-14.832 2.254l-42.584-24.595a191.577 191.577 0 0 1-60.759 35.13v49.182a12.01 12.01 0 0 1-9.377 11.718c-34.956 7.85-72.499 8.256-109.219.007-5.49-1.233-9.403-6.096-9.403-11.723v-49.184a191.555 191.555 0 0 1-60.759-35.13l-42.584 24.595a12.016 12.016 0 0 1-14.832-2.254c-24.718-26.744-43.619-58.944-54.689-94.586-1.667-5.366.592-11.175 5.459-13.985L67.212 291.1a193.48 193.48 0 0 1 0-70.199l-42.616-24.599c-4.867-2.809-7.126-8.618-5.459-13.985 11.07-35.642 29.97-67.842 54.689-94.586a12.016 12.016 0 0 1 14.832-2.254l42.584 24.595a191.577 191.577 0 0 1 60.759-35.13V25.759a12.01 12.01 0 0 1 9.377-11.718c34.956-7.85 72.499-8.256 109.219-.007 5.49 1.233 9.403 6.096 9.403 11.723v49.184a191.555 191.555 0 0 1 60.759 35.13l42.584-24.595a12.016 12.016 0 0 1 14.832 2.254c24.718 26.744 43.619 58.944 54.689 94.586 1.667 5.366-.592 11.175-5.459 13.985L444.788 220.9a193.485 193.485 0 0 1 0 70.2zM336 256c0-44.112-35.888-80-80-80s-80 35.888-80 80 35.888 80 80 80 80-35.888 80-80z"></path></svg></a> <div class="user-settings-menu" style="display:none;"><div class="theme-options"><!----> <ul class="color-theme-options"><li><a href="#" class="default-theme"></a></li> <li><a href="#" class="blue-theme"></a></li><li><a href="#" class="red-theme"></a></li><li><a href="#" class="purple-theme"></a></li></ul> <div class="dark-theme-options toggle-option"><label for="dark-theme-toggle">🌗 Dark Theme</label> <input id="dark-theme-toggle" type="checkbox"></div> <div class="ignore-themes-options toggle-option"><label for="ignore-themes-toggle">Ignore Other Themes?</label> <input id="ignore-themes-toggle" type="checkbox"></div> <!----></div></div></div> <!----> <div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <!----></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><!---->  <ul class="sidebar-links"><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>GETTING STARTED</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/" aria-current="page" class="sidebar-link">What is GraphShield?</a></li><li><a href="/how-does-it-work.html" class="sidebar-link">How does it Work?</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading"><span>SECURITY &amp; COMPLIANCE POLICIES</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/policies/" class="sidebar-link">Understanding Policies and Rules</a></li><li><a href="/policies/conditional-access.html" class="sidebar-link">Conditional Access Policy</a></li><li><a href="/policies/auditing.html" class="sidebar-link">Auditing Policy</a></li><li><a href="/policies/classification.html" class="sidebar-link">Classification Policy</a></li><li><a href="/policies/vip-protection.html" class="sidebar-link">VIP Protection Policy</a></li><li><a href="/policies/beta-endpoints.html" class="sidebar-link">Beta Endpoints Policy</a></li><li><a href="/policies/anonymization.html" class="sidebar-link">Anonymization Policy</a></li></ul></section></li><li><section class="sidebar-group depth-0"><p class="sidebar-heading open"><span>INTEGRATE YOUR APPS</span> <!----></p> <ul class="sidebar-links sidebar-group-items"><li><a href="/integration/" aria-current="page" class="sidebar-link">Getting Started</a></li><li><a href="/integration/authentication.html" aria-current="page" class="active sidebar-link">Authentication</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/integration/authentication.html#abstract" class="sidebar-link">Abstract</a></li><li class="sidebar-sub-header"><a href="/integration/authentication.html#using-a-microsoft-identity-platform-national-environment" class="sidebar-link">Using a Microsoft Identity Platform national environment</a></li></ul></li><li><a href="/integration/async-operations.html" class="sidebar-link">Async Operations</a></li><li><a href="/integration/subscriptions.html" class="sidebar-link">Subscriptions</a></li><li><a href="/integration/throttling.html" class="sidebar-link">Throttling Guidance</a></li><li><a href="/integration/errors.html" class="sidebar-link">Error Responses</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><p class="sidebar-heading"><span>TRUST CENTER</span> <span class="arrow right"></span></p> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="authentication"><a href="#authentication" class="header-anchor">#</a> Authentication</h1> <blockquote><p>GraphShield was designed so that it interfere as less as possible with your authentication process.</p></blockquote> <h2 id="abstract"><a href="#abstract" class="header-anchor">#</a> Abstract</h2> <p>GraphShield supports two modes of authentication, <code>Standard</code> and <code>Hardened</code>.</p> <div class="custom-block tip"><p class="custom-block-title">TIP</p> <ul><li>The <code>Standard</code> mode is perfect to use GraphShield without any additional constraints.</li> <li>The <code>Hardened</code> mode may be required when you're dealing with a strictly controlled Microsoft 365 environment.</li></ul></div> <h3 id="standard-mode"><a href="#standard-mode" class="header-anchor">#</a> Standard mode</h3> <p>In standard mode, to call the Microsoft Graph API through GraphShield, your application just need to acquire a regular OAuth 2.0 Access token from the Microsoft Identity Platform, and present it in either of the following:</p> <ul><li>The HTTP <code>Authorization</code> request header, as a <code>Bearer</code> token</li> <li>The graph client constructor, when using a Microsoft Graph client library</li></ul> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><p>It means that in standard mode, <strong>GraphShield is completely transparent regarding your authentication process</strong>, as you're dealing directly with the Microsoft Identity Platform. Therefore you can refer to the standard <a href="https://docs.microsoft.com/en-us/graph/auth/" target="_blank" rel="noopener noreferrer">Microsoft Graph auth overview<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for reference to understand how to acquire an access token.</p> <h3 id="hardened-mode"><a href="#hardened-mode" class="header-anchor">#</a> Hardened mode</h3> <p>To cope with advanced security and compliance requirements in certain Microsoft 365 environments, GraphShield offers an additional layer of security for Microsoft 365 organizations through the concept of &quot;Virtual Tokens&quot;.</p> <p><strong>Virtual Tokens prevents apps from directly accessing real application id and secrets, bringing an additional layer of security by completely preventing an app to be able to bypass GraphShield and to make direct requests to the Microsoft Graph.</strong></p> <p>With GraphShield, they are only two differences with the regular flow:</p> <ul><li>You're calling <code>https://microsoftidentity.graphshield.app</code> instead of the regular <code>https://login.microsoftonline.com</code> URLs.</li> <li>You're passing a virtual app id and a virtual app secret instead of the real one. These app id and secret are verified then dynamically substituted by the real one during the proxying process.</li></ul> <p>We're currently supporting virtual tokens in these two main scenarios, that should cover 99% of the situations:</p> <ul><li>Access on behalf of a user: Used by <strong>single page apps</strong>, <strong>web apps</strong>, and <strong>natively installed apps</strong></li> <li>Access without a user: Used for <strong>server-to-server</strong> interactions that must run in the background</li></ul> <div class="custom-block warning"><p class="custom-block-title">Other OAuth 2.0 and OpenID protocols</p> <p>If you need to use other protocols, such as <code>OAuth 2.0 on-behalf-of flow</code> or <code>OAuth 2.0 device code flow</code>, just <a href="https://www.graphshield.io/#contact" target="_blank" rel="noopener noreferrer">contact us<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <h4 id="access-on-behalf-of-a-user"><a href="#access-on-behalf-of-a-user" class="header-anchor">#</a> Access on behalf of a user</h4> <p>The <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-auth-code-flow" target="_blank" rel="noopener noreferrer">OAuth 2.0 authorization code flow<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> is described in <a href="https://tools.ietf.org/html/rfc6749" target="_blank" rel="noopener noreferrer">section 4.1 of the OAuth 2.0 specification<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>. It's used to perform authentication and authorization in the majority of app types, including single page apps, web apps, and natively installed apps. The flow enables apps to securely acquire access_tokens that can be used to access resources secured by the Microsoft identity platform, as well as refresh tokens to get additional access_tokens, and ID tokens for the signed in user.</p> <p>By using GraphShield, the resulting process is completely transparent and does not impact your app:</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><div class="custom-block warning"><p class="custom-block-title">Using a national environment? (US, DE, CN...)</p> <p>See <a href="#using-a-microsoft-identity-platform-national-environment">Using a specific Microsoft Identity Platform environment</a> if required.</p></div> <h4 id="access-without-a-user"><a href="#access-without-a-user" class="header-anchor">#</a> Access without a user</h4> <p>You can use the <a href="https://docs.microsoft.com/en-us/azure/active-directory/develop/v2-oauth2-client-creds-grant-flow" target="_blank" rel="noopener noreferrer">OAuth 2.0 client credentials grant<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> specified in <a href="https://tools.ietf.org/html/rfc6749#section-4.4" target="_blank" rel="noopener noreferrer">RFC 6749<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>, sometimes called &quot;two-legged OAuth&quot;, to access web-hosted resources by using the identity of an application. This type of grant is commonly used for server-to-server interactions that must run in the background, without immediate interaction with a user. These types of applications are often referred to as daemons or service accounts.</p> <p>By using GraphShield, the resulting process is completely transparent and does not impact your app:</p> <div class="spinner" style="background:rgb(66, 185, 131);" data-v-1bbcb91a></div><div class="custom-block warning"><p class="custom-block-title">Using a national environment? (US, DE, CN...)</p> <p>See <a href="#using-a-microsoft-identity-platform-national-environment">Using a specific Microsoft Identity Platform environment</a> if required.</p></div> <h2 id="using-a-microsoft-identity-platform-national-environment"><a href="#using-a-microsoft-identity-platform-national-environment" class="header-anchor">#</a> Using a Microsoft Identity Platform national environment</h2> <p>The Microsoft Identity Platform is available from different environments, and you have to use a different URL for each of them, for instance:</p> <ul><li>Azure AD for US Government: <code>https://login.microsoftonline.us</code></li> <li>Azure AD Germany: <code>https://login.microsoftonline.de</code></li> <li>Azure AD China operated by 21Vianet: <code>https://login.chinacloudapi.cn</code></li></ul> <p>See <a href="https://docs.microsoft.com/en-us/graph/deployments#app-registration-and-token-service-root-endpoints" target="_blank" rel="noopener noreferrer">Token service root endpoints<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a> for reference.</p> <p>If you're in the situation where you need to access one of these specific Microsoft Identity Platform environments, just <a href="https://www.graphshield.io/#contact" target="_blank" rel="noopener noreferrer">contact us<span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a>.</p></div> <footer class="page-edit"><div class="edit-link"><a href="https://github.com/guillaumemeyer/docs/edit/master/public/integration/authentication.md" target="_blank" rel="noopener noreferrer">📝 Improve this page!</a> <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></div> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/integration/" class="prev router-link-active">
        Getting Started
      </a></span> <span class="next"><a href="/integration/async-operations.html">
        Async Operations
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/assets/js/app.800fda4e.js" defer></script><script src="/assets/js/2.356b9677.js" defer></script><script src="/assets/js/12.8a1893de.js" defer></script>
  </body>
</html>
